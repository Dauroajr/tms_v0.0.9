{% extends 'base.html' %}
{% load static i18n l10n %}

{% block title %}
{% if object %}
{% translate 'Edit Employee' %} - {{ object.full_name }}
{% else %}
{% translate 'Add Employee' %}
{% endif %} - TMS
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <!-- Page Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2>
            <i class="bi bi-person-plus"></i>
            {% if object %}
            {% translate "Edit Employee" %}
            {% else %}
            {% translate "Add New Employee" %}
            {% endif %}
          </h2>
          <p class="text-muted">
            {% if object %}
            {% translate "Update employee information" %}
            {% else %}
            {% translate "Register a new employee" %}
            {% endif %}
          </p>
        </div>
        <div>
          <a href="{% url 'personnel:employee_list' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> {% translate "Back" %}
          </a>
        </div>
      </div>

      <!-- Form Card -->
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            {% if form.non_field_errors %}
            <div class="alert alert-danger" role="alert">
              {{ form.non_field_errors }}
            </div>
            {% endif %}

            <!-- Employee Type & Number -->
            <h5 class="mb-3">
              <i class="bi bi-card-heading"></i> {% translate "Employee Information" %}
            </h5>

            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.employee_type.id_for_label }}" class="form-label">
                  {% translate "Employee Type" %} <span class="text-danger">*</span>
                </label>
                {{ form.employee_type }}
                {% if form.employee_type.errors %}
                <div class="invalid-feedback d-block">{{ form.employee_type.errors }}</div>
                {% endif %}
              </div>
              <div class="col-md-6">
                <label for="{{ form.employee_number.id_for_label }}" class="form-label">
                  {% translate "Employee Number" %}
                </label>
                {{ form.employee_number }}
                {% if form.employee_number.errors %}
                <div class="invalid-feedback d-block">{{ form.employee_number.errors }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Personal Information -->
            <h5 class="mb-3 mt-4">
              <i class="bi bi-person"></i> {% translate "Personal Information" %}
            </h5>

            <div class="row g-3 mb-4">
              <div class="col-md-12">
                <label for="{{ form.full_name.id_for_label }}" class="form-label">
                  {% translate "Full Name" %} <span class="text-danger">*</span>
                </label>
                {{ form.full_name }}
                {% if form.full_name.errors %}
                <div class="invalid-feedback d-block">{{ form.full_name.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.cpf.id_for_label }}" class="form-label">
                  {% translate "CPF" %} <span class="text-danger">*</span>
                </label>
                {{ form.cpf }}
                {% if form.cpf.errors %}
                <div class="invalid-feedback d-block">{{ form.cpf.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.rg.id_for_label }}" class="form-label">
                  {% translate "RG" %}
                </label>
                {{ form.rg }}
                {% if form.rg.errors %}
                <div class="invalid-feedback d-block">{{ form.rg.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.birth_date.id_for_label }}" class="form-label">
                  {% translate "Birth Date" %}
                </label>
                {{ form.birth_date }}
                {% if form.birth_date.errors %}
                <div class="invalid-feedback d-block">{{ form.birth_date.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-12">
                <label for="{{ form.gender.id_for_label }}" class="form-label">
                  {% translate "Gender" %}
                </label>
                {{ form.gender }}
                {% if form.gender.errors %}
                <div class="invalid-feedback d-block">{{ form.gender.errors }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Contact Information -->
            <h5 class="mb-3 mt-4">
              <i class="bi bi-telephone"></i> {% translate "Contact Information" %}
            </h5>

            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.phone.id_for_label }}" class="form-label">
                  {% translate "Phone" %} <span class="text-danger">*</span>
                </label>
                {{ form.phone }}
                {% if form.phone.errors %}
                <div class="invalid-feedback d-block">{{ form.phone.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-6">
                <label for="{{ form.email.id_for_label }}" class="form-label">
                  {% translate "Email" %}
                </label>
                {{ form.email }}
                {% if form.email.errors %}
                <div class="invalid-feedback d-block">{{ form.email.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-12">
                <label for="{{ form.address.id_for_label }}" class="form-label">
                  {% translate "Address" %}
                </label>
                {{ form.address }}
                {% if form.address.errors %}
                <div class="invalid-feedback d-block">{{ form.address.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-6">
                <label for="{{ form.city.id_for_label }}" class="form-label">
                  {% translate "City" %}
                </label>
                {{ form.city }}
                {% if form.city.errors %}
                <div class="invalid-feedback d-block">{{ form.city.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-3">
                <label for="{{ form.state.id_for_label }}" class="form-label">
                  {% translate "State" %}
                </label>
                {{ form.state }}
                {% if form.state.errors %}
                <div class="invalid-feedback d-block">{{ form.state.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-3">
                <label for="{{ form.zip_code.id_for_label }}" class="form-label">
                  {% translate "ZIP Code" %}
                </label>
                {{ form.zip_code }}
                {% if form.zip_code.errors %}
                <div class="invalid-feedback d-block">{{ form.zip_code.errors }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Employment Information -->
            <h5 class="mb-3 mt-4">
              <i class="bi bi-briefcase"></i> {% translate "Employment Information" %}
            </h5>

            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.hire_date.id_for_label }}" class="form-label">
                  {% translate "Hire Date" %} <span class="text-danger">*</span>
                </label>
                {{ form.hire_date }}
                {% if form.hire_date.errors %}
                <div class="invalid-feedback d-block">{{ form.hire_date.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-6">
                <label for="{{ form.status.id_for_label }}" class="form-label">
                  {% translate "Status" %} <span class="text-danger">*</span>
                </label>
                {{ form.status }}
                {% if form.status.errors %}
                <div class="invalid-feedback d-block">{{ form.status.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.salary.id_for_label }}" class="form-label">
                  {% translate "Salary" %}
                </label>
                {{ form.salary }}
                {% if form.salary.errors %}
                <div class="invalid-feedback d-block">{{ form.salary.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.payment_cycle.id_for_label }}" class="form-label">
                  {% translate "Payment Cycle" %}
                </label>
                {{ form.payment_cycle }}
                {% if form.payment_cycle.errors %}
                <div class="invalid-feedback d-block">{{ form.payment_cycle.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.payment_method.id_for_label }}" class="form-label">
                  {% translate "Payment Method" %}
                </label>
                {{ form.payment_method }}
                {% if form.payment_method.errors %}
                <div class="invalid-feedback d-block">{{ form.payment_method.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.bank_name.id_for_label }}" class="form-label">
                  {% translate "Bank" %}
                </label>
                {{ form.bank_name }}
                {% if form.bank_name.errors %}
                <div class="invalid-feedback d-block">{{ form.bank_name.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.bank_branch.id_for_label }}" class="form-label">
                  {% translate "Branch" %}
                </label>
                {{ form.bank_branch }}
                {% if form.bank_branch.errors %}
                <div class="invalid-feedback d-block">{{ form.bank_branch.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.bank_account.id_for_label }}" class="form-label">
                  {% translate "Account" %}
                </label>
                {{ form.bank_account }}
                {% if form.bank_account.errors %}
                <div class="invalid-feedback d-block">{{ form.bank_account.errors }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Emergency Contact -->
            <h5 class="mb-3 mt-4">
              <i class="bi bi-exclamation-triangle"></i> {% translate "Emergency Contact" %}
            </h5>

            <div class="row g-3 mb-4">
              <div class="col-md-4">
                <label for="{{ form.emergency_contact_name.id_for_label }}" class="form-label">
                  {% translate "Name" %}
                </label>
                {{ form.emergency_contact_name }}
                {% if form.emergency_contact_name.errors %}
                <div class="invalid-feedback d-block">{{ form.emergency_contact_name.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.emergency_contact_relationship.id_for_label }}" class="form-label">
                  {% translate "Relationship" %}
                </label>
                {{ form.emergency_contact_relationship }}
                {% if form.emergency_contact_relationship.errors %}
                <div class="invalid-feedback d-block">{{ form.emergency_contact_relationship.errors }}</div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.emergency_contact_phone.id_for_label }}" class="form-label">
                  {% translate "Phone" %}
                </label>
                {{ form.emergency_contact_phone }}
                {% if form.emergency_contact_phone.errors %}
                <div class="invalid-feedback d-block">{{ form.emergency_contact_phone.errors }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Photo & Notes -->
            <h5 class="mb-3 mt-4">
              <i class="bi bi-image"></i> {% translate "Additional Information" %}
            </h5>

            <div class="mb-4">
              <label for="{{ form.photo.id_for_label }}" class="form-label">
                {% translate "Photo" %}
              </label>
              {% if object and object.photo %}
              <div class="mb-2">
                <img src="{{ object.photo.url }}" alt="{{ object.full_name }}" class="img-thumbnail"
                  style="max-width: 150px;">
              </div>
              {% endif %}
              {{ form.photo }}
              {% if form.photo.errors %}
              <div class="invalid-feedback d-block">{{ form.photo.errors }}</div>
              {% endif %}
            </div>

            <div class="mb-4">
              <label for="{{ form.notes.id_for_label }}" class="form-label">
                {% translate "Notes" %}
              </label>
              {{ form.notes }}
              {% if form.notes.errors %}
              <div class="invalid-feedback d-block">{{ form.notes.errors }}</div>
              {% endif %}
            </div>

            <!-- Form Actions -->
            <div class="d-flex justify-content-between mt-4">
              <a href="{% url 'personnel:employee_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-x-circle"></i> {% translate "Cancel" %}
              </a>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle"></i>
                {% if object %}
                {% translate "Update Employee" %}
                {% else %}
                {% translate "Create Employee" %}
                {% endif %}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
